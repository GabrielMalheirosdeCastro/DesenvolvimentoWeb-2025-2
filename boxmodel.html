<!DOCTYPE html>
<html lang="pt-BR" class="html-page">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Adivinha a Nave Espacial | Gabriel Malheiros FAESA</title>
    
    <!-- CSS do sistema existente para manter consist√™ncia -->
    <link rel="stylesheet" href="style.css">
    
    <!-- CSS espec√≠fico do Box Model para este jogo -->
    <link rel="stylesheet" href="boxmodel.css">
    
    <meta name="description" content="Jogo de adivinha√ß√£o de naves espaciais - Teste seus conhecimentos sobre naves de Star Wars, Halo e LEGO!">
    <meta name="author" content="Gabriel Malheiros de Castro - FAESA 2025-2">
</head>
<body class="html-page boxmodel-game-page">
    <!-- üöÄ Container Principal do Jogo -->
    <div class="game-container">
        <!-- üéØ Cabe√ßalho do Jogo -->
        <header class="game-header">
            <h1 class="game-title">
                üöÄ Adivinha a Nave Espacial
            </h1>
            <p class="game-subtitle">
                Teste seus conhecimentos sobre naves espaciais de diferentes universos!
            </p>
            
            <!-- üìä Placar e Estat√≠sticas -->
            <div class="score-board">
                <div class="score-item">
                    <span class="score-label">Pontua√ß√£o:</span>
                    <span class="score-value" id="current-score">0</span>
                </div>
                <div class="score-item">
                    <span class="score-label">Acertos:</span>
                    <span class="score-value" id="correct-answers">0</span>
                </div>
                <div class="score-item">
                    <span class="score-label">Total:</span>
                    <span class="score-value" id="total-attempts">0</span>
                </div>
            </div>
        </header>

        <!-- üéÆ √Årea Principal do Jogo -->
        <main class="game-main">
            <!-- üñºÔ∏è Container da Imagem com Box Model -->
            <section class="image-section">
                <div class="image-container" id="image-container">
                    <div class="image-frame">
                        <img id="spaceship-image" 
                             src="" 
                             alt="Nave espacial para adivinha√ß√£o" 
                             class="spaceship-image"
                             style="display: none;">
                        
                        <!-- Loading placeholder -->
                        <div class="image-placeholder" id="image-placeholder">
                            <div class="placeholder-icon">üöÄ</div>
                            <div class="placeholder-text">Carregando pr√≥xima nave...</div>
                        </div>
                        
                        <!-- Error fallback -->
                        <div class="image-error" id="image-error" style="display: none;">
                            <div class="error-icon">‚ùå</div>
                            <div class="error-text">Erro ao carregar imagem</div>
                        </div>
                    </div>
                    
                    <!-- üìù Informa√ß√µes da Categoria -->
                    <div class="category-hint" id="category-hint">
                        <span class="hint-label">Categoria:</span>
                        <span class="hint-value" id="category-value">-</span>
                    </div>
                </div>
            </section>

            <!-- üéØ √Årea de Resposta -->
            <section class="answer-section">
                <div class="answer-container">
                    <div class="question-text">
                        <h2>Qual √© o nome desta nave espacial?</h2>
                        <p class="question-subtitle">Digite sua resposta abaixo:</p>
                    </div>
                    
                    <!-- üìù Input de Resposta -->
                    <div class="input-container">
                        <input type="text" 
                               id="answer-input" 
                               class="answer-input" 
                               placeholder="Digite o nome da nave..."
                               autocomplete="off"
                               maxlength="50">
                        
                        <button id="submit-answer" class="submit-button" type="button">
                            <span class="button-text">Responder</span>
                            <span class="button-icon">‚ú®</span>
                        </button>
                    </div>
                    
                    <!-- üí° Dicas -->
                    <div class="hints-container" id="hints-container" style="display: none;">
                        <h3 class="hints-title">üí° Dicas:</h3>
                        <ul class="hints-list" id="hints-list">
                            <!-- Dicas ser√£o inseridas dinamicamente -->
                        </ul>
                        <button id="show-hint" class="hint-button">
                            Mostrar Dica
                        </button>
                    </div>
                </div>
            </section>

            <!-- ‚úÖ‚ùå √Årea de Feedback -->
            <section class="feedback-section" id="feedback-section" style="display: none;">
                <div class="feedback-container">
                    <div class="feedback-content" id="feedback-content">
                        <!-- Feedback ser√° inserido dinamicamente -->
                    </div>
                    
                    <div class="feedback-actions">
                        <button id="next-question" class="next-button">
                            Pr√≥xima Nave üöÄ
                        </button>
                        <button id="reveal-info" class="info-button">
                            Ver Detalhes üìñ
                        </button>
                    </div>
                </div>
            </section>

            <!-- üìñ Informa√ß√µes Detalhadas -->
            <section class="details-section" id="details-section" style="display: none;">
                <div class="details-container">
                    <h3 class="details-title">üìñ Informa√ß√µes da Nave</h3>
                    <div class="details-content" id="details-content">
                        <!-- Detalhes ser√£o inseridos dinamicamente -->
                    </div>
                </div>
            </section>
        </main>

        <!-- üéõÔ∏è Controles do Jogo -->
        <aside class="game-controls">
            <div class="controls-container">
                <h3 class="controls-title">üéõÔ∏è Controles</h3>
                
                <div class="controls-grid">
                    <button id="new-game" class="control-button new-game">
                        <span class="control-icon">üîÑ</span>
                        <span class="control-text">Novo Jogo</span>
                    </button>
                    
                    <button id="skip-question" class="control-button skip">
                        <span class="control-icon">‚è≠Ô∏è</span>
                        <span class="control-text">Pular</span>
                    </button>
                    
                    <button id="toggle-difficulty" class="control-button difficulty">
                        <span class="control-icon">‚öôÔ∏è</span>
                        <span class="control-text">Dificuldade</span>
                    </button>
                    
                    <button id="show-stats" class="control-button stats">
                        <span class="control-icon">üìä</span>
                        <span class="control-text">Estat√≠sticas</span>
                    </button>
                </div>
                
                <!-- üéöÔ∏è Configura√ß√µes -->
                <div class="game-settings" id="game-settings" style="display: none;">
                    <h4>‚öôÔ∏è Configura√ß√µes</h4>
                    <div class="setting-item">
                        <label for="difficulty-select">Dificuldade:</label>
                        <select id="difficulty-select" class="setting-select">
                            <option value="easy">F√°cil (com dicas)</option>
                            <option value="medium" selected>M√©dio (dicas limitadas)</option>
                            <option value="hard">Dif√≠cil (sem dicas)</option>
                        </select>
                    </div>
                    
                    <div class="setting-item">
                        <label for="category-filter">Categoria:</label>
                        <select id="category-filter" class="setting-select">
                            <option value="all">Todas as categorias</option>
                            <option value="star-wars">Star Wars</option>
                            <option value="halo">Halo</option>
                            <option value="lego">LEGO</option>
                        </select>
                    </div>
                </div>
            </div>
        </aside>

        <!-- üìä Modal de Estat√≠sticas -->
        <div class="modal" id="stats-modal" style="display: none;">
            <div class="modal-overlay" id="modal-overlay"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">üìä Suas Estat√≠sticas</h3>
                    <button class="modal-close" id="close-stats">√ó</button>
                </div>
                <div class="modal-body" id="stats-content">
                    <!-- Estat√≠sticas ser√£o inseridas dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- üß≠ Navega√ß√£o -->
    <nav class="navigation-section">
        <div class="nav-container">
            <h3 class="nav-title">üß≠ Navega√ß√£o</h3>
            <div class="nav-buttons">
                <a href="index.html" class="nav-button primary">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Portfolio Principal</span>
                </a>
                
                <a href="galeria-lego-naves.html" class="nav-button secondary">
                    <span class="nav-icon">üß±</span>
                    <span class="nav-text">Galeria LEGO</span>
                </a>
                
                <a href="lab-fundamentos-css.html" class="nav-button secondary">
                    <span class="nav-icon">üé®</span>
                    <span class="nav-text">Lab CSS</span>
                </a>
                
                <a href="tipografia.html" class="nav-button secondary">
                    <span class="nav-icon">üìù</span>
                    <span class="nav-text">Tipografia</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- üìú Scripts -->
    <script>
        // üöÄ Dados das naves espaciais
        const spaceshipData = [
            // Naves Star Wars
            {
                id: 'venator-upgraded',
                name: 'Venator Star Destroyer Melhorado',
                image: '/assets/naves-espaciais/Star wars Venator upgraded.jpg',
                category: 'Star Wars',
                difficulty: 'medium',
                hints: ['√â uma nave capital da Rep√∫blica', 'Tem formato triangular', 'Foi usada nas Guerras Clone'],
                description: 'Uma vers√£o aprimorada do ic√¥nico Venator-class Star Destroyer da Rep√∫blica Gal√°ctica.',
                specifications: {
                    length: '1,137 metros',
                    crew: '7,400 soldados clone',
                    armament: 'Turbolasers duplos pesados'
                }
            },
            {
                id: 'venator-standard',
                name: 'Venator Star Destroyer',
                image: '/assets/naves-espaciais/Star wars venator.jpg',
                category: 'Star Wars',
                difficulty: 'easy',
                hints: ['Nave capital da Rep√∫blica', 'Formato triangular ic√¥nico', 'Protagonista nas Guerras Clone'],
                description: 'O backbone da frota da Rep√∫blica durante as Guerras Clone.',
                specifications: {
                    length: '1,137 metros',
                    crew: '7,400 soldados clone',
                    armament: 'Turbolasers e canh√µes de √≠ons'
                }
            },
            {
                id: 'acclamator',
                name: 'Acclamator Assault Ship',
                image: '/assets/naves-espaciais/starwars acclamator 2.jpg',
                category: 'Star Wars',
                difficulty: 'hard',
                hints: ['Nave de transporte e assalto', 'Usada pela Rep√∫blica', 'Menor que um Star Destroyer'],
                description: 'Nave de assalto e transporte de tropas da Rep√∫blica.',
                specifications: {
                    length: '752 metros',
                    crew: '700 soldados + 16,000 tropas',
                    armament: 'Turbolasers qu√°druplos'
                }
            },
            // Naves Halo
            {
                id: 'unsc-frigate',
                name: 'UNSC Frigate',
                image: '/assets/naves-espaciais/unsc frigate.jpg',
                category: 'Halo',
                difficulty: 'medium',
                hints: ['Nave da UNSC', 'Universo Halo', 'Classe Frigate'],
                description: 'Nave de guerra da For√ßa Espacial das Na√ß√µes Unidas.',
                specifications: {
                    length: '478 metros',
                    crew: '250-300 tripulantes',
                    armament: 'MAC Gun e m√≠sseis Archer'
                }
            },
            // Naves LEGO
            {
                id: 'mini-nave-1',
                name: 'Mini Nave Alpha',
                image: './src/assets/lego-naves/mini-nave-1.jpg',
                category: 'LEGO',
                difficulty: 'easy',
                hints: ['Mini nave LEGO', 'Primeira da s√©rie', 'Constru√ß√£o compacta'],
                description: 'Primeira mini nave da s√©rie de constru√ß√µes LEGO espaciais.',
                specifications: {
                    size: 'Pequeno (6x4 studs)',
                    pieces: '~25 pe√ßas',
                    colors: 'Vermelho, Cinza, Preto'
                }
            },
            {
                id: 'mini-nave-2',
                name: 'Mini Nave Beta',
                image: './src/assets/lego-naves/mini-nave-2.jpg',
                category: 'LEGO',
                difficulty: 'medium',
                hints: ['Mini nave LEGO', 'Segunda da s√©rie', 'Design mais complexo'],
                description: 'Segunda mini nave com estrutura multi-se√ß√µes mais avan√ßada.',
                specifications: {
                    size: 'M√©dio (8x6 studs)',
                    pieces: '~35 pe√ßas',
                    colors: 'Azul, Cinza, Preto'
                }
            },
            {
                id: 'mini-nave-3',
                name: 'Mini Nave Gamma',
                image: './src/assets/lego-naves/mini-nave-3.jpg',
                category: 'LEGO',
                difficulty: 'hard',
                hints: ['Mini nave LEGO', 'Terceira da s√©rie', 'Design √∫nico'],
                description: 'Terceira e mais avan√ßada mini nave da s√©rie com design assim√©trico.',
                specifications: {
                    size: 'Grande (10x8 studs)',
                    pieces: '~45 pe√ßas',
                    colors: 'Verde, Cinza, Preto'
                }
            }
        ];

        // üéÆ Estado do jogo
        let gameState = {
            currentShip: null,
            score: 0,
            correctAnswers: 0,
            totalAttempts: 0,
            difficulty: 'medium',
            categoryFilter: 'all',
            hintsUsed: 0,
            gameHistory: []
        };

        // üîß Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Iniciando jogo de adivinha√ß√£o de naves...');
            
            // Inicializar elementos
            initializeGame();
            loadNextQuestion();
            
            // Event listeners
            setupEventListeners();
            
            // Log de inicializa√ß√£o
            console.log('‚úÖ Jogo inicializado com sucesso!');
        });

        // üîß Inicializar o jogo
        function initializeGame() {
            updateScoreDisplay();
            resetFeedback();
            
            // Carregar configura√ß√µes salvas (localStorage)
            if (localStorage.getItem('spaceshipGameStats')) {
                const savedStats = JSON.parse(localStorage.getItem('spaceshipGameStats'));
                gameState.score = savedStats.score || 0;
                gameState.correctAnswers = savedStats.correctAnswers || 0;
                gameState.totalAttempts = savedStats.totalAttempts || 0;
                updateScoreDisplay();
            }
        }

        // üéØ Carregar pr√≥xima pergunta
        function loadNextQuestion() {
            console.log('üîÑ Carregando pr√≥xima pergunta...');
            
            // Filtrar naves por categoria
            let availableShips = spaceshipData;
            if (gameState.categoryFilter !== 'all') {
                availableShips = spaceshipData.filter(ship => 
                    ship.category.toLowerCase().replace(' ', '-') === gameState.categoryFilter
                );
            }
            
            // Selecionar nave aleat√≥ria
            const randomIndex = Math.floor(Math.random() * availableShips.length);
            gameState.currentShip = availableShips[randomIndex];
            gameState.hintsUsed = 0;
            
            // Resetar interface
            resetFeedback();
            document.getElementById('answer-input').value = '';
            document.getElementById('answer-input').focus();
            
            // Carregar imagem
            loadShipImage();
            
            // Atualizar categoria
            document.getElementById('category-value').textContent = gameState.currentShip.category;
            
            console.log(`‚úÖ Nova nave carregada: ${gameState.currentShip.name}`);
        }

        // üñºÔ∏è Carregar imagem da nave
        function loadShipImage() {
            const img = document.getElementById('spaceship-image');
            const placeholder = document.getElementById('image-placeholder');
            const errorDiv = document.getElementById('image-error');
            
            // Mostrar placeholder
            placeholder.style.display = 'flex';
            img.style.display = 'none';
            errorDiv.style.display = 'none';
            
            // Carregar imagem
            img.onload = function() {
                placeholder.style.display = 'none';
                img.style.display = 'block';
                console.log('‚úÖ Imagem carregada com sucesso');
            };
            
            img.onerror = function() {
                placeholder.style.display = 'none';
                errorDiv.style.display = 'flex';
                console.error('‚ùå Erro ao carregar imagem:', gameState.currentShip.image);
            };
            
            img.src = gameState.currentShip.image;
            img.alt = `Nave espacial: ${gameState.currentShip.name}`;
        }

        // üìù Event listeners
        function setupEventListeners() {
            // Resposta
            document.getElementById('submit-answer').addEventListener('click', submitAnswer);
            document.getElementById('answer-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    submitAnswer();
                }
            });
            
            // Controles
            document.getElementById('new-game').addEventListener('click', newGame);
            document.getElementById('skip-question').addEventListener('click', skipQuestion);
            document.getElementById('next-question').addEventListener('click', loadNextQuestion);
            document.getElementById('reveal-info').addEventListener('click', toggleDetails);
            document.getElementById('show-hint').addEventListener('click', showHint);
            
            // Configura√ß√µes
            document.getElementById('toggle-difficulty').addEventListener('click', toggleSettings);
            document.getElementById('difficulty-select').addEventListener('change', updateDifficulty);
            document.getElementById('category-filter').addEventListener('change', updateCategoryFilter);
            
            // Modal
            document.getElementById('show-stats').addEventListener('click', showStats);
            document.getElementById('close-stats').addEventListener('click', closeStats);
            document.getElementById('modal-overlay').addEventListener('click', closeStats);
        }

        // ‚úÖ Submeter resposta - VERS√ÉO APRIMORADA
        function submitAnswer() {
            const answer = document.getElementById('answer-input').value.trim();
            
            // üîç Valida√ß√£o de entrada aprimorada
            if (!answer) {
                showInputError('Por favor, digite uma resposta antes de submeter!');
                focusAnswerInput();
                return;
            }
            
            if (answer.length < 2) {
                showInputError('A resposta deve ter pelo menos 2 caracteres!');
                focusAnswerInput();
                return;
            }
            
            // üõ°Ô∏è Sanitiza√ß√£o de entrada
            const sanitizedAnswer = sanitizeInput(answer);
            
            // üéØ Verifica√ß√£o de resposta com feedback detalhado
            const validationResult = checkAnswerAdvanced(sanitizedAnswer);
            gameState.totalAttempts++;
            
            if (validationResult.isCorrect) {
                gameState.correctAnswers++;
                gameState.score += calculateScore();
                showFeedback(true, sanitizedAnswer, validationResult);
                
                // üéä Efeito visual de acerto
                celebrateCorrectAnswer();
            } else {
                showFeedback(false, sanitizedAnswer, validationResult);
                
                // üí° Sugest√µes inteligentes
                if (validationResult.suggestions.length > 0) {
                    showSuggestions(validationResult.suggestions);
                }
            }
            
            updateScoreDisplay();
            saveGameStats();
            logUserActivity(sanitizedAnswer, validationResult.isCorrect);
        }
        
        // üõ°Ô∏è Fun√ß√£o de sanitiza√ß√£o de entrada
        function sanitizeInput(input) {
            return input
                .trim()
                .replace(/[^\w\s-]/gi, '') // Remove caracteres especiais
                .replace(/\s+/g, ' ')      // Remove espa√ßos duplos
                .toLowerCase();
        }
        
        // üîç Verifica√ß√£o avan√ßada de resposta
        function checkAnswerAdvanced(answer) {
            const correctName = gameState.currentShip.name.toLowerCase();
            const result = {
                isCorrect: false,
                confidence: 0,
                matchedWords: [],
                suggestions: [],
                feedbackType: 'exact'
            };
            
            // 1Ô∏è‚É£ Verifica√ß√£o exata
            if (answer === correctName) {
                result.isCorrect = true;
                result.confidence = 100;
                result.feedbackType = 'exact';
                return result;
            }
            
            // 2Ô∏è‚É£ Verifica√ß√£o sem acentos e caracteres especiais
            const normalizedCorrect = normalizeText(correctName);
            const normalizedAnswer = normalizeText(answer);
            
            if (normalizedAnswer === normalizedCorrect) {
                result.isCorrect = true;
                result.confidence = 95;
                result.feedbackType = 'normalized';
                return result;
            }
            
            // 3Ô∏è‚É£ Verifica√ß√£o de palavras-chave
            const correctWords = correctName.split(' ').filter(word => word.length > 2);
            const answerWords = answer.split(' ');
            
            let matchedWords = [];
            let totalConfidence = 0;
            
            correctWords.forEach(correctWord => {
                answerWords.forEach(answerWord => {
                    const similarity = calculateSimilarity(correctWord, answerWord);
                    if (similarity > 0.7) {
                        matchedWords.push(correctWord);
                        totalConfidence += similarity;
                    }
                });
            });
            
            result.matchedWords = matchedWords;
            result.confidence = (matchedWords.length / correctWords.length) * 100;
            
            // 4Ô∏è‚É£ Crit√©rio de acerto por palavras-chave
            const requiredMatches = Math.ceil(correctWords.length * 0.6); // 60% das palavras
            if (matchedWords.length >= requiredMatches && result.confidence >= 60) {
                result.isCorrect = true;
                result.feedbackType = 'partial';
            }
            
            // 5Ô∏è‚É£ Gerar sugest√µes se n√£o acertou
            if (!result.isCorrect) {
                result.suggestions = generateSmartSuggestions(answer, correctName);
            }
            
            return result;
        }
        
        // üîß Fun√ß√£o auxiliar para normalizar texto
        function normalizeText(text) {
            return text
                .normalize("NFD")
                .replace(/[\u0300-\u036f]/g, "") // Remove acentos
                .toLowerCase()
                .replace(/[^\w\s]/g, ''); // Remove caracteres especiais
        }
        
        // üìä Calcular similaridade entre strings
        function calculateSimilarity(str1, str2) {
            const longer = str1.length > str2.length ? str1 : str2;
            const shorter = str1.length > str2.length ? str2 : str1;
            
            if (longer.length === 0) return 1.0;
            
            const distance = levenshteinDistance(longer, shorter);
            return (longer.length - distance) / longer.length;
        }
        
        // üî¢ Algoritmo de Levenshtein Distance
        function levenshteinDistance(str1, str2) {
            const matrix = [];
            
            for (let i = 0; i <= str2.length; i++) {
                matrix[i] = [i];
            }
            
            for (let j = 0; j <= str1.length; j++) {
                matrix[0][j] = j;
            }
            
            for (let i = 1; i <= str2.length; i++) {
                for (let j = 1; j <= str1.length; j++) {
                    if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1,
                            matrix[i][j - 1] + 1,
                            matrix[i - 1][j] + 1
                        );
                    }
                }
            }
            
            return matrix[str2.length][str1.length];
        }
        
        // üí° Gerar sugest√µes inteligentes
        function generateSmartSuggestions(userAnswer, correctAnswer) {
            const suggestions = [];
            const correctWords = correctAnswer.split(' ');
            const userWords = userAnswer.split(' ');
            
            // Sugest√£o 1: Palavras que o usu√°rio esqueceu
            const missingWords = correctWords.filter(word => 
                !userWords.some(userWord => 
                    calculateSimilarity(word, userWord) > 0.5
                )
            );
            
            if (missingWords.length > 0) {
                suggestions.push(`Tente incluir: "${missingWords[0]}"`);
            }
            
            // Sugest√£o 2: Corre√ß√£o de grafia
            correctWords.forEach(correctWord => {
                userWords.forEach(userWord => {
                    const similarity = calculateSimilarity(correctWord, userWord);
                    if (similarity > 0.4 && similarity < 0.8) {
                        suggestions.push(`"${userWord}" ‚Üí "${correctWord}"?`);
                    }
                });
            });
            
            // Sugest√£o 3: Categoria da nave
            if (gameState.currentShip.category) {
                suggestions.push(`√â uma nave da categoria: ${gameState.currentShip.category}`);
            }
            
            return suggestions.slice(0, 2); // M√°ximo 2 sugest√µes
        }
        
        // üéä Efeito visual de comemora√ß√£o
        function celebrateCorrectAnswer() {
            // Criar confetti visual
            const confetti = document.createElement('div');
            confetti.innerHTML = 'üéâüéä‚ú®üåü‚≠ê';
            confetti.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 3rem;
                z-index: 9999;
                pointer-events: none;
                animation: celebrate 2s ease-out forwards;
            `;
            
            document.body.appendChild(confetti);
            
            // Adicionar anima√ß√£o CSS dinamicamente
            if (!document.querySelector('#celebrate-animation')) {
                const style = document.createElement('style');
                style.id = 'celebrate-animation';
                style.textContent = `
                    @keyframes celebrate {
                        0% {
                            transform: translate(-50%, -50%) scale(0) rotate(0deg);
                            opacity: 1;
                        }
                        50% {
                            transform: translate(-50%, -50%) scale(1.5) rotate(180deg);
                            opacity: 1;
                        }
                        100% {
                            transform: translate(-50%, -50%) scale(1) rotate(360deg);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            setTimeout(() => {
                if (confetti.parentNode) {
                    confetti.parentNode.removeChild(confetti);
                }
            }, 2000);
        }
        
        // ‚ùå Mostrar erro de entrada
        function showInputError(message) {
            const answerInput = document.getElementById('answer-input');
            
            // Remover classe de erro anterior
            answerInput.classList.remove('input-error');
            
            // Adicionar classe de erro
            answerInput.classList.add('input-error');
            
            // Criar tooltip de erro
            const errorTooltip = document.createElement('div');
            errorTooltip.className = 'error-tooltip';
            errorTooltip.textContent = message;
            errorTooltip.style.cssText = `
                position: absolute;
                background: #ef4444;
                color: white;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 14px;
                z-index: 1000;
                top: -45px;
                left: 0;
                white-space: nowrap;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                animation: errorShake 0.5s ease-in-out;
            `;
            
            answerInput.parentNode.style.position = 'relative';
            answerInput.parentNode.appendChild(errorTooltip);
            
            // Adicionar anima√ß√£o de shake
            if (!document.querySelector('#error-animation')) {
                const style = document.createElement('style');
                style.id = 'error-animation';
                style.textContent = `
                    .input-error {
                        border-color: #ef4444 !important;
                        box-shadow: 0 0 10px rgba(239, 68, 68, 0.3) !important;
                    }
                    
                    @keyframes errorShake {
                        0%, 100% { transform: translateX(0); }
                        25% { transform: translateX(-5px); }
                        75% { transform: translateX(5px); }
                    }
                `;
                document.head.appendChild(style);
            }
            
            // Remover erro ap√≥s 3 segundos
            setTimeout(() => {
                answerInput.classList.remove('input-error');
                if (errorTooltip.parentNode) {
                    errorTooltip.parentNode.removeChild(errorTooltip);
                }
            }, 3000);
        }
        
        // üéØ Focar no campo de resposta
        function focusAnswerInput() {
            const answerInput = document.getElementById('answer-input');
            answerInput.focus();
            answerInput.select();
        }
        
        // üí° Mostrar sugest√µes
        function showSuggestions(suggestions) {
            if (suggestions.length === 0) return;
            
            const suggestionsContainer = document.createElement('div');
            suggestionsContainer.className = 'suggestions-container';
            suggestionsContainer.innerHTML = `
                <div class="suggestions-header">üí° Dicas:</div>
                ${suggestions.map(suggestion => 
                    `<div class="suggestion-item">${suggestion}</div>`
                ).join('')}
            `;
            
            suggestionsContainer.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: rgba(59, 130, 246, 0.9);
                color: white;
                padding: 15px;
                border-radius: 10px;
                max-width: 300px;
                z-index: 1000;
                font-size: 14px;
                backdrop-filter: blur(5px);
                animation: slideInRight 0.3s ease-out;
            `;
            
            document.body.appendChild(suggestionsContainer);
            
            // Auto-remover ap√≥s 5 segundos
            setTimeout(() => {
                if (suggestionsContainer.parentNode) {
                    suggestionsContainer.style.animation = 'slideOutRight 0.3s ease-in';
                    setTimeout(() => {
                        if (suggestionsContainer.parentNode) {
                            suggestionsContainer.parentNode.removeChild(suggestionsContainer);
                        }
                    }, 300);
                }
            }, 5000);
        }
        
        // üìù Log de atividade do usu√°rio
        function logUserActivity(answer, wasCorrect) {
            const activity = {
                timestamp: new Date().toISOString(),
                question: gameState.currentShip.name,
                userAnswer: answer,
                correct: wasCorrect,
                attempts: gameState.totalAttempts,
                hintsUsed: gameState.hintsUsed,
                score: gameState.score
            };
            
            console.log('üìä Atividade do usu√°rio:', activity);
            
            // Salvar hist√≥rico local (opcional)
            const history = JSON.parse(localStorage.getItem('boxmodel-history') || '[]');
            history.push(activity);
            
            // Manter apenas √∫ltimas 50 tentativas
            if (history.length > 50) {
                history.splice(0, history.length - 50);
            }
            
            localStorage.setItem('boxmodel-history', JSON.stringify(history));
        }

        // üîç Verificar resposta
        function checkAnswer(answer) {
            const correctName = gameState.currentShip.name.toLowerCase();
            const userAnswer = answer.toLowerCase();
            
            // Verifica√ß√£o exata
            if (userAnswer === correctName) {
                return true;
            }
            
            // Verifica√ß√£o parcial (palavras-chave)
            const keywords = correctName.split(' ');
            const matchedKeywords = keywords.filter(keyword => 
                userAnswer.includes(keyword) && keyword.length > 2
            );
            
            return matchedKeywords.length >= Math.ceil(keywords.length / 2);
        }

        // üìä Calcular pontua√ß√£o
        function calculateScore() {
            let baseScore = 100;
            
            // Penalizar por dicas usadas
            baseScore -= (gameState.hintsUsed * 20);
            
            // Bonus por dificuldade
            if (gameState.currentShip.difficulty === 'hard') {
                baseScore += 50;
            } else if (gameState.currentShip.difficulty === 'medium') {
                baseScore += 25;
            }
            
            return Math.max(baseScore, 10); // M√≠nimo 10 pontos
        }

        // üí¨ Mostrar feedback
        function showFeedback(isCorrect, userAnswer) {
            const feedbackSection = document.getElementById('feedback-section');
            const feedbackContent = document.getElementById('feedback-content');
            
            if (isCorrect) {
                feedbackContent.innerHTML = `
                    <div class="feedback-success">
                        <div class="feedback-icon">üéâ</div>
                        <div class="feedback-message">
                            <h3>Parab√©ns! Resposta correta!</h3>
                            <p>Voc√™ acertou: <strong>${gameState.currentShip.name}</strong></p>
                            <p class="score-earned">+${calculateScore()} pontos</p>
                        </div>
                    </div>
                `;
            } else {
                feedbackContent.innerHTML = `
                    <div class="feedback-error">
                        <div class="feedback-icon">üòû</div>
                        <div class="feedback-message">
                            <h3>Resposta incorreta!</h3>
                            <p>Voc√™ disse: <em>"${userAnswer}"</em></p>
                            <p>A resposta correta √©: <strong>${gameState.currentShip.name}</strong></p>
                        </div>
                    </div>
                `;
            }
            
            feedbackSection.style.display = 'block';
        }

        // üí° Mostrar dica
        function showHint() {
            if (gameState.hintsUsed >= gameState.currentShip.hints.length) {
                alert('N√£o h√° mais dicas dispon√≠veis!');
                return;
            }
            
            const hintsContainer = document.getElementById('hints-container');
            const hintsList = document.getElementById('hints-list');
            
            const hint = gameState.currentShip.hints[gameState.hintsUsed];
            const listItem = document.createElement('li');
            listItem.textContent = hint;
            hintsList.appendChild(listItem);
            
            gameState.hintsUsed++;
            hintsContainer.style.display = 'block';
            
            if (gameState.hintsUsed >= gameState.currentShip.hints.length) {
                document.getElementById('show-hint').style.display = 'none';
            }
        }

        // üìñ Toggle detalhes
        function toggleDetails() {
            const detailsSection = document.getElementById('details-section');
            const detailsContent = document.getElementById('details-content');
            
            if (detailsSection.style.display === 'none') {
                detailsContent.innerHTML = generateDetailsHTML();
                detailsSection.style.display = 'block';
            } else {
                detailsSection.style.display = 'none';
            }
        }

        // üìù Gerar HTML dos detalhes
        function generateDetailsHTML() {
            const ship = gameState.currentShip;
            
            let specificationsHTML = '';
            if (ship.specifications) {
                specificationsHTML = '<div class="specifications"><h4>üìä Especifica√ß√µes:</h4><ul>';
                for (const [key, value] of Object.entries(ship.specifications)) {
                    specificationsHTML += `<li><strong>${key}:</strong> ${value}</li>`;
                }
                specificationsHTML += '</ul></div>';
            }
            
            return `
                <div class="ship-details">
                    <h4>${ship.name}</h4>
                    <p><strong>Categoria:</strong> ${ship.category}</p>
                    <p><strong>Dificuldade:</strong> ${ship.difficulty}</p>
                    <div class="description">
                        <h4>üìñ Descri√ß√£o:</h4>
                        <p>${ship.description}</p>
                    </div>
                    ${specificationsHTML}
                </div>
            `;
        }

        // üîÑ Fun√ß√µes de controle
        function newGame() {
            if (confirm('Tem certeza que deseja come√ßar um novo jogo? O progresso atual ser√° perdido.')) {
                gameState.score = 0;
                gameState.correctAnswers = 0;
                gameState.totalAttempts = 0;
                gameState.gameHistory = [];
                updateScoreDisplay();
                loadNextQuestion();
                saveGameStats();
            }
        }

        function skipQuestion() {
            if (confirm('Tem certeza que deseja pular esta pergunta?')) {
                gameState.totalAttempts++;
                updateScoreDisplay();
                loadNextQuestion();
                saveGameStats();
            }
        }

        function toggleSettings() {
            const settings = document.getElementById('game-settings');
            settings.style.display = settings.style.display === 'none' ? 'block' : 'none';
        }

        function updateDifficulty() {
            gameState.difficulty = document.getElementById('difficulty-select').value;
            console.log('Dificuldade alterada para:', gameState.difficulty);
        }

        function updateCategoryFilter() {
            gameState.categoryFilter = document.getElementById('category-filter').value;
            console.log('Filtro de categoria alterado para:', gameState.categoryFilter);
        }

        // üìä Estat√≠sticas
        function showStats() {
            const modal = document.getElementById('stats-modal');
            const content = document.getElementById('stats-content');
            
            const accuracy = gameState.totalAttempts > 0 ? 
                Math.round((gameState.correctAnswers / gameState.totalAttempts) * 100) : 0;
            
            content.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">${gameState.score}</div>
                        <div class="stat-label">Pontua√ß√£o Total</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${gameState.correctAnswers}</div>
                        <div class="stat-label">Respostas Corretas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${gameState.totalAttempts}</div>
                        <div class="stat-label">Total de Tentativas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${accuracy}%</div>
                        <div class="stat-label">Taxa de Acerto</div>
                    </div>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        function closeStats() {
            document.getElementById('stats-modal').style.display = 'none';
        }

        // üíæ Salvar/Carregar dados
        function saveGameStats() {
            const stats = {
                score: gameState.score,
                correctAnswers: gameState.correctAnswers,
                totalAttempts: gameState.totalAttempts,
                lastPlayed: new Date().toISOString()
            };
            localStorage.setItem('spaceshipGameStats', JSON.stringify(stats));
        }

        // üîÑ Fun√ß√µes utilit√°rias
        function updateScoreDisplay() {
            document.getElementById('current-score').textContent = gameState.score;
            document.getElementById('correct-answers').textContent = gameState.correctAnswers;
            document.getElementById('total-attempts').textContent = gameState.totalAttempts;
        }

        function resetFeedback() {
            document.getElementById('feedback-section').style.display = 'none';
            document.getElementById('details-section').style.display = 'none';
            document.getElementById('hints-container').style.display = 'none';
            document.getElementById('hints-list').innerHTML = '';
            document.getElementById('show-hint').style.display = 'block';
        }
    </script>
</body>
</html>